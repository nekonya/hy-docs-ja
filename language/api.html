<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hy (the language) &mdash; hy 0.10.0 documentation</title>
    
    <link rel="stylesheet" href="../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="hy 0.10.0 documentation" href="../index.html" />
    <link rel="up" title="Documentation Index" href="index.html" />
    <link rel="next" title="Hy Core" href="core.html" />
    <link rel="prev" title="Command Line Interface" href="cli.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="core.html" title="Hy Core"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cli.html" title="Command Line Interface"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">hy 0.10.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Documentation Index</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="hy-the-language">
<h1>Hy (the language)<a class="headerlink" href="#hy-the-language" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is incomplete; please consider contributing to the documentation
effort.</p>
</div>
<div class="section" id="theory-of-hy">
<h2>Theory of Hy<a class="headerlink" href="#theory-of-hy" title="Permalink to this headline">¶</a></h2>
<p>Hy maintains, over everything else, 100% compatibility in both directions
with Python itself. All Hy code follows a few simple rules. Memorize
this, it&#8217;s going to come in handy.</p>
<p>These rules help make sure code is idiomatic and interface-able in both
languages.</p>
<blockquote>
<div><ul class="simple">
<li>Symbols in earmufs will be translated to the uppercased version of that
string. For example, <cite>*foo*</cite> will become <cite>FOO</cite>.</li>
<li>UTF-8 entities will be encoded using
<a class="reference external" href="http://en.wikipedia.org/wiki/Punycode">punycode</a> and prefixed with
<cite>hy_</cite>. For instance, <cite>⚘</cite> will become <cite>hy_w7h</cite>, <cite>♥</cite> will become <cite>hy_g6h</cite>,
and <cite>i♥u</cite> will become <cite>hy_iu_t0x</cite>.</li>
<li>Symbols that contain dashes will have them replaced with underscores. For
example, <cite>render-template</cite> will become <cite>render_template</cite>. This means that
symbols with dashes will shadow their underscore equivalents, and vice
versa.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="builtins">
<h2>Builtins<a class="headerlink" href="#builtins" title="Permalink to this headline">¶</a></h2>
<p>Hy features a number of special forms that are used to help generate
correct Python AST. The following are &#8220;special&#8221; forms, which may have
behavior that&#8217;s slightly unexpected in some situations.</p>
<div class="section" id="id1">
<h3>.<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.13.</span></p>
</div>
<p><cite>.</cite> is used to perform attribute access on objects. It uses a small DSL
to allow quick access to attributes and items in a nested datastructure.</p>
<p>For instance,</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="k">. </span><span class="nv">foo</span> <span class="nv">bar</span> <span class="nv">baz</span> <span class="p">[(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)]</span> <span class="nv">frob</span><span class="p">)</span>
</pre></div>
</div>
<p>Compiles down to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">frob</span>
</pre></div>
</div>
<p><cite>.</cite> compiles its first argument (in the example, <cite>foo</cite>) as the object on
which to do the attribute dereference. It uses bare symbols as
attributes to access (in the example, <cite>bar</cite>, <cite>baz</cite>, <cite>frob</cite>), and
compiles the contents of lists (in the example, <tt class="docutils literal"><span class="pre">[(+</span> <span class="pre">1</span> <span class="pre">2)]</span></tt>) for
indexation. Other arguments throw a compilation error.</p>
<p>Access to unknown attributes throws an <tt class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></tt>. Access to
unknown keys throws an <tt class="xref py py-exc docutils literal"><span class="pre">IndexError</span></tt> (on lists and tuples) or a
<tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt> (on dicts).</p>
</div>
<div class="section" id="id2">
<h3>-&gt;<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><cite>-&gt;</cite> or <cite>threading macro</cite> is used to avoid nesting of expressions. The threading
macro inserts each expression into the next expression’s first argument place.
The following code demonstrates this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">output</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nf">output</span> <span class="mi">5</span><span class="p">))</span>
<span class="mi">10</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>-&gt;&gt;<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p><cite>-&gt;&gt;</cite> or <cite>threading tail macro</cite> is similar to <cite>threading macro</cite> but instead of
inserting each expression into the next expression’s first argument place, it
appends it as the last argument. The following code demonstrates this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">output</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">5</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nf">output</span> <span class="mi">5</span><span class="p">))</span>
<span class="mi">5</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="apply">
<h3>apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p><cite>apply</cite> is used to apply an optional list of arguments and an optional
dictionary of kwargs to a function.</p>
<p>Usage: <cite>(apply fn-name [args] [kwargs])</cite></p>
<p>Examples:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">thunk</span> <span class="p">[]</span>
  <span class="s">&quot;hy there&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">thunk</span><span class="p">)</span>
<span class="c1">;=&gt; &quot;hy there&quot;</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="nv">price</span> <span class="nv">amount</span> <span class="o">&amp;</span><span class="nv">optional</span> <span class="p">[</span><span class="nv">fees</span> <span class="mf">1.05</span><span class="p">]</span> <span class="p">[</span><span class="nv">vat</span> <span class="mf">1.1</span><span class="p">]]</span>
  <span class="p">(</span><span class="nb">* </span><span class="nv">price</span> <span class="nv">amount</span> <span class="nv">fees</span> <span class="nv">vat</span><span class="p">))</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">15</span><span class="p">])</span>
<span class="c1">;=&gt; 173.25</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">15</span><span class="p">]</span> <span class="p">{</span><span class="s">&quot;vat&quot;</span> <span class="mf">1.05</span><span class="p">})</span>
<span class="c1">;=&gt; 165.375</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[]</span> <span class="p">{</span><span class="s">&quot;price&quot;</span> <span class="mi">10</span> <span class="s">&quot;amount&quot;</span> <span class="mi">15</span> <span class="s">&quot;vat&quot;</span> <span class="mf">1.05</span><span class="p">})</span>
<span class="c1">;=&gt; 165.375</span>
</pre></div>
</div>
</div>
<div class="section" id="and">
<h3>and<a class="headerlink" href="#and" title="Permalink to this headline">¶</a></h3>
<p><cite>and</cite> form is used in logical expressions. It takes at least two parameters. If
all parameters evaluate to <cite>True</cite> the last parameter is returned. In any other
case the first false value will be returned. Examples of usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="nv">True</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="p">[]</span> <span class="nv">False</span> <span class="nv">True</span><span class="p">)</span>
<span class="p">[]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>and</cite> shortcuts and stops evaluating parameters as soon as the first
false is encountered.</p>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello&quot;</span><span class="p">))</span>
<span class="nv">False</span>
</pre></div>
</div>
</div>
<div class="section" id="assert">
<h3>assert<a class="headerlink" href="#assert" title="Permalink to this headline">¶</a></h3>
<p><cite>assert</cite> is used to verify conditions while the program is running. If the
condition is not met, an <cite>AssertionError</cite> is raised. The example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nb">assert </span><span class="p">(</span><span class="nb">= </span><span class="nv">variable</span> <span class="nv">expected-value</span><span class="p">))</span>
</pre></div>
</div>
<p>Assert takes a single parameter, a conditional that evaluates to either <cite>True</cite>
or <cite>False</cite>.</p>
</div>
<div class="section" id="assoc">
<h3>assoc<a class="headerlink" href="#assoc" title="Permalink to this headline">¶</a></h3>
<p><cite>assoc</cite> form is used to associate a key with a value in a dictionary or to set
an index of a list to a value. It takes at least three parameters: <cite>datastructure</cite>
to be modified, <cite>key</cite> or <cite>index</cite>  and <cite>value</cite>. If more than three parameters are
used it will associate in pairs.</p>
<p>Examples of usage:</p>
<div class="highlight-clj"><div class="highlight"><pre>=&gt;(let [[collection {}]]
... (assoc collection &quot;Dog&quot; &quot;Bark&quot;)
... (print collection))
{u&#39;Dog&#39;: u&#39;Bark&#39;}

=&gt;(let [[collection {}]]
... (assoc collection &quot;Dog&quot; &quot;Bark&quot; &quot;Cat&quot; &quot;Meow&quot;)
... (print collection))
{u&#39;Cat&#39;: u&#39;Meow&#39;, u&#39;Dog&#39;: u&#39;Bark&#39;}

=&gt;(let [[collection [1 2 3 4]]]
... (assoc collection 2 None)
... (print collection))
[1, 2, None, 4]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>assoc</cite> modifies the datastructure in place and returns <cite>None</cite>.</p>
</div>
</div>
<div class="section" id="break">
<h3>break<a class="headerlink" href="#break" title="Permalink to this headline">¶</a></h3>
<p><cite>break</cite> is used to break out from a loop. It terminates the loop immediately.</p>
<p>The following example has an infinite while loop that is terminated as soon as
the user enters <cite>k</cite>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="s">&quot;k&quot;</span> <span class="p">(</span><span class="nf">raw-input</span> <span class="s">&quot;? &quot;</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">break</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Try again&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="cond">
<h3>cond<a class="headerlink" href="#cond" title="Permalink to this headline">¶</a></h3>
<p><cite>cond</cite> macro can be used to build nested if-statements.</p>
<p>The following example shows the relationship between the macro and the expanded
code:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nb">cond </span><span class="p">[</span><span class="nv">condition-1</span> <span class="nv">result-1</span><span class="p">]</span>
      <span class="p">[</span><span class="nv">condition-2</span> <span class="nv">result-2</span><span class="p">])</span>

<span class="p">(</span><span class="k">if </span><span class="nv">condition-1</span> <span class="nv">result-1</span>
  <span class="p">(</span><span class="k">if </span><span class="nv">condition-2</span> <span class="nv">result-2</span><span class="p">))</span>
</pre></div>
</div>
<p>As shown below only the first matching result block is executed.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">check-value</span> <span class="p">[</span><span class="nv">value</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">cond </span><span class="p">[(</span><span class="nb">&lt; </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is smaller than 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[(</span><span class="nb">= </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is equal to 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[(</span><span class="nb">&gt; </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is greater than 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[</span><span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is something that it should not be&quot;</span><span class="p">)]))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">check-value</span> <span class="mi">6</span><span class="p">)</span>
<span class="nv">value</span> <span class="nv">is</span> <span class="nv">greater</span> <span class="nv">than</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="continue">
<h3>continue<a class="headerlink" href="#continue" title="Permalink to this headline">¶</a></h3>
<p><cite>continue</cite> returns execution to the start of a loop. In the following example,
function <cite>(side-effect1)</cite> is called for each iteration. <cite>(side-effect2)</cite>
however is called only for every other value in the list.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="c1">;; assuming that (side-effect1) and (side-effect2) are functions and</span>
<span class="c1">;; collection is a list of numerical values</span>

<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">do</span>
    <span class="p">(</span><span class="nf">side-effect1</span> <span class="nv">x</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">%</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">continue</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">side-effect2</span> <span class="nv">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="do-progn">
<h3>do / progn<a class="headerlink" href="#do-progn" title="Permalink to this headline">¶</a></h3>
<p>the <cite>do</cite> and <cite>progn</cite> forms are used to evaluate each of their arguments and
return the last one. Return values from every other than the last argument are
discarded. It can be used in <cite>lambda</cite> or <cite>list-comp</cite> to perform more complex
logic as shown by one of the examples.</p>
<p>Some example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">if </span><span class="nv">true</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Side effects rock!&quot;</span><span class="p">)</span>
<span class="nv">...</span>      <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Yeah, really!&quot;</span><span class="p">)))</span>
<span class="nv">Side</span> <span class="nv">effects</span> <span class="nv">rock!</span>
<span class="nv">Yeah</span>, <span class="nv">really!</span>

<span class="c1">;; assuming that (side-effect) is a function that we want to call for each</span>
<span class="c1">;; and every value in the list, but which return values we do not care</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">side-effect</span> <span class="nv">x</span><span class="p">)</span>
<span class="nv">...</span>               <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">x</span><span class="p">)</span>
<span class="nv">...</span>                   <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="nv">x</span><span class="p">)))</span>
<span class="nv">...</span>           <span class="p">(</span><span class="nf">x</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)))</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span>, <span class="mi">20</span>, <span class="mi">24</span>, <span class="mi">28</span>, <span class="mi">32</span>, <span class="mi">36</span><span class="p">]</span>
</pre></div>
</div>
<p><cite>do</cite> can accept any number of arguments, from 1 to n.</p>
</div>
<div class="section" id="def-setv">
<h3>def / setv<a class="headerlink" href="#def-setv" title="Permalink to this headline">¶</a></h3>
<p><cite>def</cite> and <cite>setv</cite> are used to bind value, object or a function to a symbol. For
example:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">names</span> <span class="p">[</span><span class="s">&quot;Alice&quot;</span> <span class="s">&quot;Bob&quot;</span> <span class="s">&quot;Charlie&quot;</span><span class="p">])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">print </span><span class="nv">names</span><span class="p">)</span>
<span class="p">[</span><span class="nv">u</span><span class="ss">&#39;Alice</span><span class="o">&#39;</span>, <span class="nv">u</span><span class="ss">&#39;Bob</span><span class="o">&#39;</span>, <span class="nv">u</span><span class="ss">&#39;Charlie</span><span class="o">&#39;</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">counter</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">collection</span> <span class="nv">item</span><span class="p">]</span> <span class="p">(</span><span class="nf">.count</span> <span class="nv">collection</span> <span class="nv">item</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">counter</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="defclass">
<h3>defclass<a class="headerlink" href="#defclass" title="Permalink to this headline">¶</a></h3>
<p>new classes are declared with <cite>defclass</cite>. It can takes two optional parameters:
a vector defining a possible super classes and another vector containing
attributes of the new class as two item vectors.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">defclass</span> <span class="nv">class-name</span> <span class="p">[</span><span class="nv">super-class-1</span> <span class="nv">super-class-2</span><span class="p">]</span>
  <span class="p">[[</span><span class="nv">attribute</span> <span class="nv">value</span><span class="p">]])</span>
</pre></div>
</div>
<p>Both values and functions can be bound on the new class as shown by the example
below:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defclass</span> <span class="nv">Cat</span> <span class="p">[]</span>
<span class="nv">...</span>  <span class="p">[[</span><span class="nv">age</span> <span class="nv">None</span><span class="p">]</span>
<span class="nv">...</span>   <span class="p">[</span><span class="nv">colour</span> <span class="s">&quot;white&quot;</span><span class="p">]</span>
<span class="nv">...</span>   <span class="p">[</span><span class="nv">speak</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">self</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Meow&quot;</span><span class="p">))]])</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">spot</span> <span class="p">(</span><span class="nf">Cat</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">spot.colour</span> <span class="s">&quot;Black&quot;</span><span class="p">)</span>
<span class="ss">&#39;Black</span><span class="o">&#39;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">.speak</span> <span class="nv">spot</span><span class="p">)</span>
<span class="nv">Meow</span>
</pre></div>
</div>
</div>
<div class="section" id="defn-defun">
<span id="defn"></span><h3>defn / defun<a class="headerlink" href="#defn-defun" title="Permalink to this headline">¶</a></h3>
<p><cite>defn</cite> and <cite>defun</cite> macros are used to define functions. They take three
parameters: <cite>name</cite> of the function to define, vector of <cite>parameters</cite> and the
<cite>body</cite> of the function:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nb">name </span><span class="p">[</span><span class="nv">params</span><span class="p">]</span> <span class="nv">body</span><span class="p">)</span>
</pre></div>
</div>
<p>Parameters may have following keywords in front of them:</p>
<dl class="docutils">
<dt>&amp;optional</dt>
<dd><p class="first">parameter is optional. The parameter can be given as a two item list, where
the first element is parameter name and the second is the default value. The
parameter can be also given as a single item, in which case the default
value is None.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">total-value</span> <span class="p">[</span><span class="nv">value</span> <span class="o">&amp;</span><span class="nv">optional</span> <span class="p">[</span><span class="nv">value-added-tax</span> <span class="mi">10</span><span class="p">]]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">* </span><span class="nv">value</span> <span class="nv">value-added-tax</span><span class="p">)</span> <span class="mi">100</span><span class="p">)</span> <span class="nv">value</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">total-value</span> <span class="mi">100</span><span class="p">)</span>
<span class="mf">110.0</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">total-value</span> <span class="mi">100</span> <span class="mi">1</span><span class="p">)</span>
<span class="mf">101.0</span>
</pre></div>
</div>
</dd>
</dl>
<p>&amp;key</p>
<dl class="docutils">
<dt>&amp;kwargs</dt>
<dd><p class="first">parameter will contain 0 or more keyword arguments.</p>
<p>The following code examples defines a function that will print all keyword
arguments and their values.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">print-parameters</span> <span class="p">[</span><span class="o">&amp;</span><span class="nv">kwargs</span> <span class="nv">kwargs</span><span class="p">]</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nb">for </span><span class="p">[(</span>, <span class="nv">k</span> <span class="nv">v</span><span class="p">)</span> <span class="p">(</span><span class="nf">.items</span> <span class="nv">kwargs</span><span class="p">)]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">k</span> <span class="nv">v</span><span class="p">)))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">kwapply</span> <span class="p">(</span><span class="nf">print-parameters</span><span class="p">)</span> <span class="p">{</span><span class="s">&quot;parameter-1&quot;</span> <span class="mi">1</span> <span class="s">&quot;parameter-2&quot;</span> <span class="mi">2</span><span class="p">})</span>
<span class="nv">parameter-2</span> <span class="mi">2</span>
<span class="nv">parameter-1</span> <span class="mi">1</span>
</pre></div>
</div>
</dd>
<dt>&amp;rest</dt>
<dd><p class="first">parameter will contain 0 or more positional arguments. No other positional
arguments may be specified after this one.</p>
<p>The following code example defines a function that can be given 0 to n
numerical parameters. It then sums every odd number and substracts
every even number.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">zig-zag-sum</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">rest </span><span class="nv">numbers</span><span class="p">]</span>
     <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">odd-numbers</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">numbers</span><span class="p">]</span> <span class="p">(</span><span class="nf">odd?</span> <span class="nv">x</span><span class="p">))]</span>
           <span class="p">[</span><span class="nv">even-numbers</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">numbers</span><span class="p">]</span> <span class="p">(</span><span class="nf">even?</span> <span class="nv">x</span><span class="p">))]]</span>
       <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">odd-numbers</span><span class="p">)</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">even-numbers</span><span class="p">))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span><span class="p">)</span>
<span class="mi">0</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span> <span class="mi">3</span> <span class="mi">9</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">8</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>
<span class="mi">-3</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="defn-alias-defun-alias">
<span id="id4"></span><h3>defn-alias / defun-alias<a class="headerlink" href="#defn-alias-defun-alias" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.13.</span></p>
</div>
<p>The <cite>defn-alias</cite> and <cite>defun-alias</cite> macros are much like <a class="reference internal" href="#defn">defn</a> above,
with the difference that instead of defining a function with a single
name, these can also define aliases. Other than taking a list of
symbols for function names as the first parameter, <cite>defn-alias</cite> and
<cite>defun-alias</cite> have no other differences compared to <cite>defn</cite> and
<cite>defun</cite>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defn-alias</span> <span class="p">[</span><span class="nv">main-name</span> <span class="nv">alias</span><span class="p">]</span> <span class="p">[]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello!&quot;</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">main-name</span><span class="p">)</span>
<span class="s">&quot;Hello!&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">alias</span><span class="p">)</span>
<span class="s">&quot;Hello!&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="defmacro">
<span id="id5"></span><h3>defmacro<a class="headerlink" href="#defmacro" title="Permalink to this headline">¶</a></h3>
<p><cite>defmacro</cite> is used to define macros. The general format is
<cite>(defmacro name [parameters] expr)</cite>.</p>
<p>The following example defines a macro that can be used to swap order of elements in
code, allowing the user to write code in infix notation, where operator is in
between the operands.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmacro </span><span class="nv">infix</span> <span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">1</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">0</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">infix</span> <span class="p">(</span><span class="mi">1</span> <span class="nb">+ </span><span class="mi">1</span><span class="p">))</span>
<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="defmacro-alias">
<span id="id6"></span><h3>defmacro-alias<a class="headerlink" href="#defmacro-alias" title="Permalink to this headline">¶</a></h3>
<p><cite>defmacro-alias</cite> is used to define macros with multiple names
(aliases). The general format is <cite>(defmacro-alias [names] [parameters]
expr)</cite>. It creates multiple macros with the same parameter list and
body, under the specified list of names.</p>
<p>The following example defines two macros, both of which allow the user
to write code in infix notation.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defmacro-alias</span> <span class="p">[</span><span class="nv">infix</span> <span class="nv">infi</span><span class="p">]</span> <span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">1</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">0</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">infix</span> <span class="p">(</span><span class="mi">1</span> <span class="nb">+ </span><span class="mi">1</span><span class="p">))</span>
<span class="mi">2</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">infi</span> <span class="p">(</span><span class="mi">1</span> <span class="nb">+ </span><span class="mi">1</span><span class="p">))</span>
<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="defmacro-g">
<span id="id7"></span><h3>defmacro/g!<a class="headerlink" href="#defmacro-g" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><cite>defmacro/g!</cite> is a special version of <cite>defmacro</cite> that is used to
automatically generate <a class="reference internal" href="#gensym"><em>gensym</em></a> for any symbol that
starts with <tt class="docutils literal"><span class="pre">g!</span></tt>.</p>
<p>So <tt class="docutils literal"><span class="pre">g!a</span></tt> would become <tt class="docutils literal"><span class="pre">(gensym</span> <span class="pre">&quot;a&quot;)</span></tt>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="internals.html#using-gensym"><em>Using gensym for safer macros</em></a></p>
</div>
</div>
<div class="section" id="defreader">
<h3>defreader<a class="headerlink" href="#defreader" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><cite>defreader</cite> defines a reader macro, enabling you to restructure or
modify syntax.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defreader</span> <span class="o">^</span> <span class="p">[</span><span class="nv">expr</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">expr</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="o">#^</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="o">#^</span><span class="s">&quot;Hello&quot;</span>
<span class="s">&quot;Hello&quot;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="readermacros.html#reader-macros"><em>Reader Macros</em></a></p>
</div>
</div>
<div class="section" id="del">
<h3>del<a class="headerlink" href="#del" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><cite>del</cite> removes an object from the current namespace.</p>
<div class="highlight-clj"><div class="highlight"><pre>=&gt; (setv foo 42)
=&gt; (del foo)
=&gt; foo
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
NameError: name &#39;foo&#39; is not defined
</pre></div>
</div>
<p><cite>del</cite> can also remove objects from a mapping, a list, ...</p>
<div class="highlight-clj"><div class="highlight"><pre>=&gt; (setv test (list (range 10)))
=&gt; test
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
=&gt; (del (slice test 2 4)) ;; remove items from 2 to 4 excluded
=&gt; test
[0, 1, 4, 5, 6, 7, 8, 9]
=&gt; (setv dic {&quot;foo&quot; &quot;bar&quot;})
=&gt; dic
{&quot;foo&quot;: &quot;bar&quot;}
=&gt; (del (get dic &quot;foo&quot;))
=&gt; dic
{}
</pre></div>
</div>
</div>
<div class="section" id="eval">
<h3>eval<a class="headerlink" href="#eval" title="Permalink to this headline">¶</a></h3>
<p><cite>eval</cite> evaluates a quoted expression and returns the value.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello World&quot;</span><span class="p">))</span>
<span class="s">&quot;Hello World&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="eval-and-compile">
<h3>eval-and-compile<a class="headerlink" href="#eval-and-compile" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="eval-when-compile">
<h3>eval-when-compile<a class="headerlink" href="#eval-when-compile" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="first-car">
<h3>first / car<a class="headerlink" href="#first-car" title="Permalink to this headline">¶</a></h3>
<p><cite>first</cite> and <cite>car</cite> are macros for accessing the first element of a collection:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>
<span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="for">
<h3>for<a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h3>
<p><cite>for</cite> is used to call a function for each element in a list or vector.
The results of each call are discarded and the for expression returns
None instead. The example code iterates over <cite>collection</cite> and
for each <cite>element</cite> in <cite>collection</cite> calls the <cite>side-effect</cite>
function with <cite>element</cite> as its argument:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="c1">;; assuming that (side-effect) is a function that takes a single parameter</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nf">side-effect</span> <span class="nv">element</span><span class="p">))</span>

<span class="c1">;; for can have an optional else block</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nf">side-effect</span> <span class="nv">element</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nf">side-effect-2</span><span class="p">)))</span>
</pre></div>
</div>
<p>The optional <cite>else</cite> block is executed only if the <cite>for</cite> loop terminates
normally. If the execution is halted with <cite>break</cite>, the <cite>else</cite> does not execute.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">element</span> <span class="mi">3</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nb">print </span><span class="nv">element</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nf">break</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;loop finished&quot;</span><span class="p">)))</span>
<span class="mi">1</span>
<span class="mi">2</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">element</span> <span class="mi">4</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nb">print </span><span class="nv">element</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nf">break</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;loop finished&quot;</span><span class="p">)))</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="k">loop </span><span class="nv">finished</span>
</pre></div>
</div>
</div>
<div class="section" id="gensym">
<span id="id8"></span><h3>gensym<a class="headerlink" href="#gensym" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><cite>gensym</cite> form is used to generate a unique symbol to allow writing macros
without accidental variable name clashes.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">)</span>
<span class="nv">u</span><span class="o">&#39;</span><span class="ss">:G_1235</span><span class="o">&#39;</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">gensym </span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="nv">u</span><span class="o">&#39;</span><span class="ss">:x_1236</span><span class="o">&#39;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="internals.html#using-gensym"><em>Using gensym for safer macros</em></a></p>
</div>
</div>
<div class="section" id="get">
<h3>get<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h3>
<p><cite>get</cite> form is used to access single elements in lists and dictionaries. <cite>get</cite>
takes two parameters, the <cite>datastructure</cite> and the <cite>index</cite> or <cite>key</cite> of the item.
It will then return the corresponding value from the dictionary or the list.
Example usages:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">animals</span> <span class="p">{</span><span class="s">&quot;dog&quot;</span> <span class="s">&quot;bark&quot;</span> <span class="s">&quot;cat&quot;</span> <span class="s">&quot;meow&quot;</span><span class="p">}]</span>
<span class="nv">...</span>      <span class="p">[</span><span class="nv">numbers</span> <span class="p">[</span><span class="s">&quot;zero&quot;</span> <span class="s">&quot;one&quot;</span> <span class="s">&quot;two&quot;</span> <span class="s">&quot;three&quot;</span><span class="p">]]]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">get </span><span class="nv">animals</span> <span class="s">&quot;dog&quot;</span><span class="p">))</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">get </span><span class="nv">numbers</span> <span class="mi">2</span><span class="p">)))</span>
<span class="nv">bark</span>
<span class="nv">two</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>get</cite> raises a KeyError if a dictionary is queried for a non-existing
key.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>get</cite> raises an IndexError if a list or a tuple is queried for an index
that is out of bounds.</p>
</div>
</div>
<div class="section" id="global">
<h3>global<a class="headerlink" href="#global" title="Permalink to this headline">¶</a></h3>
<p><cite>global</cite> can be used to mark a symbol as global. This allows the programmer to
assign a value to a global symbol. Reading a global symbol does not require the
<cite>global</cite> keyword, just the assigning does.</p>
<p>Following example shows how global <cite>a</cite> is assigned a value in a function and later
on printed on another function. Without the <cite>global</cite> keyword, the second function
would thrown a <cite>NameError</cite>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">set-a</span> <span class="p">[</span><span class="nv">value</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">global</span> <span class="nv">a</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setv</span> <span class="nv">a</span> <span class="nv">value</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">print-a</span> <span class="p">[]</span>
  <span class="p">(</span><span class="nb">print </span><span class="nv">a</span><span class="p">))</span>

<span class="p">(</span><span class="nf">set-a</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nf">print-a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="if-if-not">
<h3>if / if-not<a class="headerlink" href="#if-if-not" title="Permalink to this headline">¶</a></h3>
<p>the <cite>if</cite> form is used to conditionally select code to be executed. It has to
contain the condition block and the block to be executed if the condition
evaluates <cite>True</cite>. Optionally it may contain a block that is executed in case
the evaluation of the condition is <cite>False</cite>. The <cite>if-not</cite> form (<em>new in
0.9.13</em>) is similar, but the first block after the test will be
executed when the test fails, while the other, conditional one, when
the test succeeds - opposite of the order of the <cite>if</cite> form.</p>
<p>Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">money-left?</span> <span class="nv">account</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;lets go shopping&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;lets go and work&quot;</span><span class="p">))</span>

<span class="p">(</span><span class="nb">if-not </span><span class="p">(</span><span class="nf">money-left?</span> <span class="nv">account</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;lets go and work&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;lets go shopping&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Truth values of Python objects are respected. Values <cite>None</cite>, <cite>False</cite>, zero of
any numeric type, empty sequence and empty dictionary are considered <cite>False</cite>.
Everything else is considered <cite>True</cite>.</p>
</div>
<div class="section" id="import">
<h3>import<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h3>
<p><cite>import</cite> is used to import modules, like in Python. There are several forms
of import you can use.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="c1">;; Imports each of these modules</span>
<span class="c1">;;</span>
<span class="c1">;; Python:</span>
<span class="c1">;; import sys</span>
<span class="c1">;; import os.path</span>
<span class="p">(</span><span class="nb">import </span><span class="nv">sys</span> <span class="nv">os.path</span><span class="p">)</span>

<span class="c1">;; Import from a module</span>
<span class="c1">;;</span>
<span class="c1">;; Python: from os.path import exists, isdir, isfile</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">os.path</span> <span class="p">[</span><span class="nv">exists</span> <span class="nv">isdir</span> <span class="nv">isfile</span><span class="p">]])</span>

<span class="c1">;; Import with an alias</span>
<span class="c1">;;</span>
<span class="c1">;; Python: import sys as systest</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">sys</span> <span class="ss">:as</span> <span class="nv">systest</span><span class="p">])</span>

<span class="c1">;; You can list as many imports as you like of different types.</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">tests.resources</span> <span class="p">[</span><span class="nv">kwtest</span> <span class="nv">function-with-a-dash</span><span class="p">]]</span>
        <span class="p">[</span><span class="nv">os.path</span> <span class="p">[</span><span class="nv">exists</span> <span class="nv">isdir</span> <span class="nv">isfile</span><span class="p">]]</span>
        <span class="p">[</span><span class="nv">sys</span> <span class="ss">:as</span> <span class="nv">systest</span><span class="p">])</span>

<span class="c1">;; Import all module functions into current namespace</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">sys</span> <span class="p">[</span><span class="nv">*</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="kwapply">
<h3>kwapply<a class="headerlink" href="#kwapply" title="Permalink to this headline">¶</a></h3>
<p><cite>kwapply</cite> can be used to supply keyword arguments to a function.</p>
<p>For example:</p>
<div class="highlight-clj"><div class="highlight"><pre>=&gt; (defn rent-car [&amp;kwargs kwargs]
...  (cond [(in :brand kwargs) (print &quot;brand:&quot; (:brand kwargs))]
...        [(in :model kwargs) (print &quot;model:&quot; (:model kwargs))]))

=&gt; (kwapply (rent-car) {:model &quot;T-Model&quot;})
model: T-Model

=&gt; (defn total-purchase [price amount &amp;optional [fees 1.05] [vat 1.1]]
...  (* price amount fees vat))

=&gt; (total-purchase 10 15)
173.25

=&gt; (kwapply (total-purchase 10 15) {&quot;vat&quot; 1.05})
165.375
</pre></div>
</div>
</div>
<div class="section" id="lambda-fn">
<h3>lambda / fn<a class="headerlink" href="#lambda-fn" title="Permalink to this headline">¶</a></h3>
<p><cite>lambda</cite> and <cite>fn</cite> can be used to define an anonymous function. The parameters are
similar to <cite>defn</cite>: first parameter is vector of parameters and the rest is the
body of the function. lambda returns a new function. In the example an anonymous
function is defined and passed to another function for filtering output.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">people</span> <span class="p">[{</span><span class="ss">:name</span> <span class="s">&quot;Alice&quot;</span> <span class="ss">:age</span> <span class="mi">20</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Bob&quot;</span> <span class="ss">:age</span> <span class="mi">25</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Charlie&quot;</span> <span class="ss">:age</span> <span class="mi">50</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Dave&quot;</span> <span class="ss">:age</span> <span class="mi">5</span><span class="p">}])</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">display-people</span> <span class="p">[</span><span class="nv">people</span> <span class="nv">filter</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">person</span> <span class="nv">people</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">filter </span><span class="nv">person</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">person</span><span class="p">)))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">display-people</span> <span class="nv">people</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">person</span><span class="p">]</span> <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="ss">:age</span> <span class="nv">person</span><span class="p">)</span> <span class="mi">25</span><span class="p">)))</span>
<span class="nv">Alice</span>
<span class="nv">Dave</span>
</pre></div>
</div>
<p>Just as in normal function definitions, if the first element of the
body is a string, it serves as docstring.  This is useful for giving
class methods docstrings.</p>
<blockquote>
<div><p>=&gt; (setv times-three
...   (fn [x]
...    &#8220;Multiplies input by three and returns the result.&#8221;
...    (* x 3)))</p>
<p>=&gt; (help times-three)
Help on function times_three:</p>
<p>times_three(x)
Multiplies input by three and returns result
(END)</p>
</div></blockquote>
</div>
<div class="section" id="let">
<h3>let<a class="headerlink" href="#let" title="Permalink to this headline">¶</a></h3>
<p><cite>let</cite> is used to create lexically scoped variables. They are created at the
beginning of <cite>let</cite> form and cease to exist after the form. The following
example showcases this behaviour:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">x</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">x</span><span class="p">)</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">x</span> <span class="mi">6</span><span class="p">]]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">x</span><span class="p">))</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="nv">x</span><span class="p">))</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">5</span>
</pre></div>
</div>
<p><cite>let</cite> macro takes two parameters: a vector defining <cite>variables</cite> and <cite>body</cite>,
which is being executed. <cite>variables</cite> is a vector where each element is either
a single variable or a vector defining a variable value pair. In case of a
single variable, it is assigned value None, otherwise the supplied value is
used.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">x</span> <span class="p">[</span><span class="nv">y</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>
<span class="nv">None</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="list-comp">
<h3>list-comp<a class="headerlink" href="#list-comp" title="Permalink to this headline">¶</a></h3>
<p><cite>list-comp</cite> performs list comprehensions. It takes two or three parameters.
The first parameter is the expression controlling the return value, while
the second is used to select items from a list. The third and optional
parameter can be used to filter out some of the items in the list based on a
conditional expression. Some examples:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">collection</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span>, <span class="mi">10</span>, <span class="mi">12</span>, <span class="mi">14</span>, <span class="mi">16</span>, <span class="mi">18</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="not">
<h3>not<a class="headerlink" href="#not" title="Permalink to this headline">¶</a></h3>
<p><cite>not</cite> form is used in logical expressions. It takes a single parameter and
returns a reversed truth value. If <cite>True</cite> is given as a parameter, <cite>False</cite>
will be returned and vice-versa. Examples for usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">True</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">False</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">None</span><span class="p">)</span>
<span class="nv">True</span>
</pre></div>
</div>
</div>
<div class="section" id="or">
<h3>or<a class="headerlink" href="#or" title="Permalink to this headline">¶</a></h3>
<p><cite>or</cite> form is used in logical expressions. It takes at least two parameters. It
will return the first non-false parameter. If no such value exist, the last
parameter will be returned.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">or </span><span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="mi">1</span> <span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>or</cite> shortcuts and stops evaluating parameters as soon as the first
true is encountered.</p>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">or </span><span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello&quot;</span><span class="p">))</span>
<span class="nv">True</span>
</pre></div>
</div>
</div>
<div class="section" id="print">
<h3>print<a class="headerlink" href="#print" title="Permalink to this headline">¶</a></h3>
<p>the <cite>print</cite> form is used to output on screen. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello world!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>print</cite> always returns None</p>
</div>
</div>
<div class="section" id="quasiquote">
<h3>quasiquote<a class="headerlink" href="#quasiquote" title="Permalink to this headline">¶</a></h3>
<p><cite>quasiquote</cite> allows you to quote a form, but also to
selectively evaluate expressions, expressions inside a <cite>quasiquote</cite>
can be selectively evaluated using <cite>unquote</cite> (~). The evaluated form can
also be spliced using <cite>unquote-splice</cite> (~&#64;). Quasiquote can be also written
using the backquote (`) symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="c1">;; let `qux&#39; be a variable with value (bar baz)</span>
<span class="o">`</span><span class="p">(</span><span class="nf">foo</span> <span class="o">~</span><span class="nv">qux</span><span class="p">)</span>
<span class="c1">; equivalent to &#39;(foo (bar baz))</span>
<span class="o">`</span><span class="p">(</span><span class="nf">foo</span> <span class="o">~@</span><span class="nv">qux</span><span class="p">)</span>
<span class="c1">; equivalent to &#39;(foo bar baz)</span>
</pre></div>
</div>
</div>
<div class="section" id="quote">
<h3>quote<a class="headerlink" href="#quote" title="Permalink to this headline">¶</a></h3>
<p><cite>quote</cite> returns the form passed to it without evaluating. <cite>quote</cite> can
be alternatively written using the (&#8216;) symbol</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello World&quot;</span><span class="p">))</span>
<span class="c1">; variable x is set to expression &amp; not evaluated</span>
<span class="nv">=&gt;</span> <span class="nv">x</span>
<span class="p">(</span><span class="nf">u</span><span class="ss">&#39;print</span><span class="o">&#39;</span> <span class="nv">u</span><span class="ss">&#39;Hello</span> <span class="nv">World</span><span class="o">&#39;</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span><span class="p">)</span>
<span class="nv">Hello</span> <span class="nv">World</span>
</pre></div>
</div>
</div>
<div class="section" id="require">
<h3>require<a class="headerlink" href="#require" title="Permalink to this headline">¶</a></h3>
<p><cite>require</cite> is used to import macros from a given module. It takes at least one
parameter specifying the module which macros should be imported. Multiple
modules can be imported with a single <cite>require</cite>.</p>
<p>The following example will import macros from <cite>module-1</cite> and <cite>module-2</cite>:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="nv">module-1</span> <span class="nv">module-2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="rest-cdr">
<h3>rest / cdr<a class="headerlink" href="#rest-cdr" title="Permalink to this headline">¶</a></h3>
<p><cite>rest</cite> and <cite>cdr</cite> return the collection passed as an argument without the first
element:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">rest </span><span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>
<span class="p">[</span><span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="slice">
<h3>slice<a class="headerlink" href="#slice" title="Permalink to this headline">¶</a></h3>
<p><cite>slice</cite> can be used to take a subset of a list and create a new list from it.
The form takes at least one parameter specifying the list to slice. Two
optional parameters can be used to give the start and end position of the
subset. If they are not supplied, default value of None will be used instead.
Third optional parameter is used to control step between the elements.</p>
<p><cite>slice</cite> follows the same rules as the Python counterpart. Negative indecies are
counted starting from the end of the list.
Some examples of
usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">collection</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">slice</span> <span class="nv">collection</span><span class="p">)</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">slice</span> <span class="nv">collection</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">[</span><span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">slice</span> <span class="nv">collection</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">slice</span> <span class="nv">collection</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">slice</span> <span class="nv">collection</span> <span class="mi">-4</span> <span class="mi">-2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">6</span>, <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="throw-raise">
<h3>throw / raise<a class="headerlink" href="#throw-raise" title="Permalink to this headline">¶</a></h3>
<p>the <cite>throw</cite> or <cite>raise</cite> forms can be used to raise an Exception at runtime.</p>
<p>Example usage</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">throw</span><span class="p">)</span>
<span class="c1">; re-rase the last exception</span>

<span class="p">(</span><span class="nf">throw</span> <span class="nv">IOError</span><span class="p">)</span>
<span class="c1">; Throw an IOError</span>

<span class="p">(</span><span class="nf">throw</span> <span class="p">(</span><span class="nf">IOError</span> <span class="s">&quot;foobar&quot;</span><span class="p">))</span>
<span class="c1">; Throw an IOError(&quot;foobar&quot;)</span>
</pre></div>
</div>
<p><cite>throw</cite> can acccept a single argument (an <cite>Exception</cite> class or instance), or
no arguments to re-raise the last Exception.</p>
</div>
<div class="section" id="try">
<h3>try<a class="headerlink" href="#try" title="Permalink to this headline">¶</a></h3>
<p>the <cite>try</cite> form is used to start a <cite>try</cite> / <cite>catch</cite> block. The form is used
as follows</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">try</span>
    <span class="p">(</span><span class="nf">error-prone-function</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">catch</span> <span class="p">[</span><span class="nv">e</span> <span class="nv">ZeroDivisionError</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Division by zero&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;no errors&quot;</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">finally</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;all done&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p><cite>try</cite> must contain at least one <cite>catch</cite> block, and may optionally have an
<cite>else</cite> or <cite>finally</cite> block. If an error is raised with a matching catch
block during execution of <cite>error-prone-function</cite> then that catch block will
be executed. If no errors are raised the <cite>else</cite> block is executed. Regardless
if an error was raised or not, the <cite>finally</cite> block is executed as last.</p>
</div>
<div class="section" id="unless">
<h3>unless<a class="headerlink" href="#unless" title="Permalink to this headline">¶</a></h3>
<p><cite>unless</cite> macro is a shorthand for writing a if-statement that checks if the
given conditional is False. The following shows how the macro expands into code.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">unless</span> <span class="nv">conditional</span> <span class="nv">statement</span><span class="p">)</span>

<span class="p">(</span><span class="k">if </span><span class="nv">conditional</span>
  <span class="nv">None</span>
  <span class="p">(</span><span class="k">do </span><span class="nv">statement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="unquote">
<h3>unquote<a class="headerlink" href="#unquote" title="Permalink to this headline">¶</a></h3>
<p>Within a quasiquoted form, <cite>unquote</cite> forces evaluation of a symbol. <cite>unquote</cite>
is aliased to the <cite>~</cite> symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nb">name </span><span class="s">&quot;Cuddles&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span><span class="nb">= name </span><span class="p">(</span><span class="nf">unquote</span> <span class="nv">name</span><span class="p">)))</span>
<span class="c1">;=&gt; (u&#39;=&#39; u&#39;name&#39; u&#39;Cuddles&#39;)</span>

<span class="o">`</span><span class="p">(</span><span class="nb">= name </span><span class="o">~</span><span class="nv">name</span><span class="p">)</span>
<span class="c1">;=&gt; (u&#39;=&#39; u&#39;name&#39; u&#39;Cuddles&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="unquote-splice">
<h3>unquote-splice<a class="headerlink" href="#unquote-splice" title="Permalink to this headline">¶</a></h3>
<p><cite>unquote-splice</cite> forces the evaluation of a symbol within a quasiquoted form,
much like <cite>unquote</cite>. <cite>unquote-splice</cite> can only be used when the symbol being
unquoted contains an iterable value, as it &#8220;splices&#8221; that iterable into the
quasiquoted form. <cite>unquote-splice</cite> is aliased to the <cite>~&#64;</cite> symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nv">nums</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">unquote-splice</span> <span class="nv">nums</span><span class="p">)))</span>
<span class="c1">;=&gt; (u&#39;+&#39; 1L 2L 3L 4L)</span>

<span class="o">`</span><span class="p">(</span><span class="nb">+ </span><span class="o">~@</span><span class="nv">nums</span><span class="p">)</span>
<span class="c1">;=&gt; (u&#39;+&#39; 1L 2L 3L 4L)</span>
</pre></div>
</div>
</div>
<div class="section" id="when">
<h3>when<a class="headerlink" href="#when" title="Permalink to this headline">¶</a></h3>
<p><cite>when</cite> is similar to <cite>unless</cite>, except it tests when the given conditional is
True. It is not possible to have an <cite>else</cite> block in <cite>when</cite> macro. The following
shows how the macro is expanded into code.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nb">when </span><span class="nv">conditional</span> <span class="nv">statement</span><span class="p">)</span>

<span class="p">(</span><span class="k">if </span><span class="nv">conditional</span> <span class="p">(</span><span class="k">do </span><span class="nv">statement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="while">
<h3>while<a class="headerlink" href="#while" title="Permalink to this headline">¶</a></h3>
<p><cite>while</cite> form is used to execute a single or more blocks as long as a condition
is being met.</p>
<p>The following example will output &#8220;hello world!&#8221; on screen indefinetely:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello world!&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="with">
<h3>with<a class="headerlink" href="#with" title="Permalink to this headline">¶</a></h3>
<p><cite>with</cite> is used to wrap execution of a block with a context manager. The context
manager can then set up the local system and tear it down in a controlled
manner. Typical example of using <cite>with</cite> is processing files. <cite>with</cite>  can bind
context to an argument or ignore it completely, as shown below:</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">with</span> <span class="p">[[</span><span class="nv">arg</span> <span class="p">(</span><span class="nf">expr</span><span class="p">)]]</span> <span class="nv">block</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with</span> <span class="p">[[(</span><span class="nf">expr</span><span class="p">)]]</span> <span class="nv">block</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with</span> <span class="p">[[</span><span class="nv">arg</span> <span class="p">(</span><span class="nf">expr</span><span class="p">)]</span> <span class="p">[(</span><span class="nf">expr</span><span class="p">)]]</span> <span class="nv">block</span><span class="p">)</span>
</pre></div>
</div>
<p>The following example will open file <cite>NEWS</cite> and print its content on screen. The
file is automatically closed after it has been processed.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="p">(</span><span class="nf">with</span> <span class="p">[[</span><span class="nv">f</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;NEWS&quot;</span><span class="p">)]]</span> <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">.read</span> <span class="nv">f</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="with-decorator">
<h3>with-decorator<a class="headerlink" href="#with-decorator" title="Permalink to this headline">¶</a></h3>
<p><cite>with-decorator</cite> is used to wrap a function with another. The function performing
decoration should accept a single value, the function being decorated and return
a new function. <cite>with-decorator</cite> takes two parameters, the function performing
decoration and the function being decorated.</p>
<p>In the following example, <cite>inc-decorator</cite> is used to decorate function <cite>addition</cite>
with a function that takes two parameters and calls the decorated function with
values that are incremented by 1. When decorated <cite>addition</cite> is called with values
1 and 1, the end result will be 4 (1+1 + 1+1).</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">inc-decorator</span> <span class="p">[</span><span class="nv">func</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">value-1</span> <span class="nv">value-2</span><span class="p">]</span> <span class="p">(</span><span class="nf">func</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-2</span> <span class="mi">1</span><span class="p">))))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">with-decorator</span> <span class="nv">inc-decorator</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">addition</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">addition</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="with-gensyms">
<span id="id9"></span><h3>with-gensyms<a class="headerlink" href="#with-gensyms" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><cite>with-gensym</cite> form is used to generate a set of <a class="reference internal" href="#gensym"><em>gensym</em></a> for use
in a macro.</p>
<div class="highlight-hy"><div class="highlight"><pre><span class="o">(</span><span class="n">with</span><span class="o">-</span><span class="n">gensyms</span> <span class="o">[</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">]</span>
  <span class="o">...)</span>
</pre></div>
</div>
<p>expands to:</p>
<div class="highlight-hy"><div class="highlight"><pre><span class="o">(</span><span class="n">let</span> <span class="o">[[</span><span class="n">a</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
      <span class="o">[</span><span class="n">b</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
      <span class="o">[</span><span class="n">c</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)]]</span>
  <span class="o">...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="internals.html#using-gensym"><em>Using gensym for safer macros</em></a></p>
</div>
</div>
<div class="section" id="yield">
<h3>yield<a class="headerlink" href="#yield" title="Permalink to this headline">¶</a></h3>
<p><cite>yield</cite> is used to create a generator object, that returns 1 or more values.
The generator is iterable and therefore can be used in loops, list
comprehensions and other similar constructs.</p>
<p>The function random-numbers shows how generators can be used to generate
infinite series without consuming infinite amount of memory.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">multiply</span> <span class="p">[</span><span class="nv">bases</span> <span class="nv">coefficients</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">for </span><span class="p">[[(</span>, <span class="nv">base</span> <span class="nv">coefficient</span><span class="p">)</span> <span class="p">(</span><span class="nf">zip</span> <span class="nv">bases</span> <span class="nv">coefficients</span><span class="p">)]]</span>
<span class="nv">...</span>   <span class="p">(</span><span class="nf">yield</span> <span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="nv">coefficient</span><span class="p">))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">multiply</span> <span class="p">(</span><span class="nb">range </span><span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">range </span><span class="mi">5</span><span class="p">))</span>
<span class="nv">&lt;generator</span> <span class="nv">object</span> <span class="nv">multiply</span> <span class="nv">at</span> <span class="mi">0</span><span class="nv">x978d8ec&gt;</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">value</span> <span class="p">[</span><span class="nv">value</span> <span class="p">(</span><span class="nf">multiply</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">4</span>, <span class="mi">9</span>, <span class="mi">16</span>, <span class="mi">25</span>, <span class="mi">36</span>, <span class="mi">49</span>, <span class="mi">64</span>, <span class="mi">81</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">import </span><span class="nv">random</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">random-numbers</span> <span class="p">[</span><span class="nv">low</span> <span class="nv">high</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="nf">yield</span> <span class="p">(</span><span class="nf">.randint</span> <span class="nv">random</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">))))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="p">(</span><span class="nb">take </span><span class="mi">15</span> <span class="p">(</span><span class="nf">random-numbers</span> <span class="mi">1</span> <span class="mi">50</span><span class="p">))])])</span>
<span class="p">[</span><span class="mi">7</span>, <span class="mi">41</span>, <span class="mi">6</span>, <span class="mi">22</span>, <span class="mi">32</span>, <span class="mi">17</span>, <span class="mi">5</span>, <span class="mi">38</span>, <span class="mi">18</span>, <span class="mi">38</span>, <span class="mi">17</span>, <span class="mi">14</span>, <span class="mi">23</span>, <span class="mi">23</span>, <span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="zipwith">
<span id="id10"></span><h3>zipwith<a class="headerlink" href="#zipwith" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.13.</span></p>
</div>
<p><cite>zipwith</cite> zips multiple lists and maps the given function over the result. It is
equilavent to calling <tt class="docutils literal"><span class="pre">zip</span></tt>, followed by calling <tt class="docutils literal"><span class="pre">map</span></tt> on the result.</p>
<p>In the following example, <cite>zipwith</cite> is used to add the contents of two lists
together. The equilavent <tt class="docutils literal"><span class="pre">map</span></tt> and <tt class="docutils literal"><span class="pre">zip</span></tt> calls follow.</p>
<div class="highlight-clj"><div class="highlight"><pre><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">import </span><span class="nv">operator.add</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zipwith</span> <span class="nv">operator.add</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">])</span>   <span class="c1">; using zipwith</span>
<span class="p">[</span><span class="mi">5</span>, <span class="mi">7</span>, <span class="mi">9</span><span class="p">]</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">map </span><span class="nv">operator.add</span> <span class="p">(</span><span class="nf">zip</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]))</span> <span class="c1">; using map+zip</span>
<span class="p">[</span><span class="mi">5</span>, <span class="mi">7</span>, <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hy (the language)</a><ul>
<li><a class="reference internal" href="#theory-of-hy">Theory of Hy</a></li>
<li><a class="reference internal" href="#builtins">Builtins</a><ul>
<li><a class="reference internal" href="#id1">.</a></li>
<li><a class="reference internal" href="#id2">-&gt;</a></li>
<li><a class="reference internal" href="#id3">-&gt;&gt;</a></li>
<li><a class="reference internal" href="#apply">apply</a></li>
<li><a class="reference internal" href="#and">and</a></li>
<li><a class="reference internal" href="#assert">assert</a></li>
<li><a class="reference internal" href="#assoc">assoc</a></li>
<li><a class="reference internal" href="#break">break</a></li>
<li><a class="reference internal" href="#cond">cond</a></li>
<li><a class="reference internal" href="#continue">continue</a></li>
<li><a class="reference internal" href="#do-progn">do / progn</a></li>
<li><a class="reference internal" href="#def-setv">def / setv</a></li>
<li><a class="reference internal" href="#defclass">defclass</a></li>
<li><a class="reference internal" href="#defn-defun">defn / defun</a></li>
<li><a class="reference internal" href="#defn-alias-defun-alias">defn-alias / defun-alias</a></li>
<li><a class="reference internal" href="#defmacro">defmacro</a></li>
<li><a class="reference internal" href="#defmacro-alias">defmacro-alias</a></li>
<li><a class="reference internal" href="#defmacro-g">defmacro/g!</a></li>
<li><a class="reference internal" href="#defreader">defreader</a></li>
<li><a class="reference internal" href="#del">del</a></li>
<li><a class="reference internal" href="#eval">eval</a></li>
<li><a class="reference internal" href="#eval-and-compile">eval-and-compile</a></li>
<li><a class="reference internal" href="#eval-when-compile">eval-when-compile</a></li>
<li><a class="reference internal" href="#first-car">first / car</a></li>
<li><a class="reference internal" href="#for">for</a></li>
<li><a class="reference internal" href="#gensym">gensym</a></li>
<li><a class="reference internal" href="#get">get</a></li>
<li><a class="reference internal" href="#global">global</a></li>
<li><a class="reference internal" href="#if-if-not">if / if-not</a></li>
<li><a class="reference internal" href="#import">import</a></li>
<li><a class="reference internal" href="#kwapply">kwapply</a></li>
<li><a class="reference internal" href="#lambda-fn">lambda / fn</a></li>
<li><a class="reference internal" href="#let">let</a></li>
<li><a class="reference internal" href="#list-comp">list-comp</a></li>
<li><a class="reference internal" href="#not">not</a></li>
<li><a class="reference internal" href="#or">or</a></li>
<li><a class="reference internal" href="#print">print</a></li>
<li><a class="reference internal" href="#quasiquote">quasiquote</a></li>
<li><a class="reference internal" href="#quote">quote</a></li>
<li><a class="reference internal" href="#require">require</a></li>
<li><a class="reference internal" href="#rest-cdr">rest / cdr</a></li>
<li><a class="reference internal" href="#slice">slice</a></li>
<li><a class="reference internal" href="#throw-raise">throw / raise</a></li>
<li><a class="reference internal" href="#try">try</a></li>
<li><a class="reference internal" href="#unless">unless</a></li>
<li><a class="reference internal" href="#unquote">unquote</a></li>
<li><a class="reference internal" href="#unquote-splice">unquote-splice</a></li>
<li><a class="reference internal" href="#when">when</a></li>
<li><a class="reference internal" href="#while">while</a></li>
<li><a class="reference internal" href="#with">with</a></li>
<li><a class="reference internal" href="#with-decorator">with-decorator</a></li>
<li><a class="reference internal" href="#with-gensyms">with-gensyms</a></li>
<li><a class="reference internal" href="#yield">yield</a></li>
<li><a class="reference internal" href="#zipwith">zipwith</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cli.html"
                        title="previous chapter">Command Line Interface</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="core.html"
                        title="next chapter">Hy Core</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../sources/language/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="core.html" title="Hy Core"
             >next</a> |</li>
        <li class="right" >
          <a href="cli.html" title="Command Line Interface"
             >previous</a> |</li>
        <li><a href="../index.html">hy 0.10.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Documentation Index</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2014, Paul Tagliamonte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>