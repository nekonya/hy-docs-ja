<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>loop/recur &mdash; hy 0.10.0 documentation</title>
    
    <link rel="stylesheet" href="../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="hy 0.10.0 documentation" href="../index.html" />
    <link rel="up" title="Contrib Modules Index" href="index.html" />
    <link rel="next" title="defmulti" href="multi.html" />
    <link rel="prev" title="Anaphoric Macros" href="anaphoric.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="multi.html" title="defmulti"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="anaphoric.html" title="Anaphoric Macros"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">hy 0.10.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Contrib Modules Index</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="loop-recur">
<h1>loop/recur<a class="headerlink" href="#loop-recur" title="Permalink to this headline">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.13.</span></p>
</div>
<p>The loop/recur macro gives programmers a simple way to use tail-call
optimization (TCO) in their Hy code.</p>
<blockquote>
<div><p>A tail call is a subroutine call that happens inside another
procedure as its final action; it may produce a return value which
is then immediately returned by the calling procedure. If any call
that a subroutine performs, such that it might eventually lead to
this same subroutine being called again down the call chain, is in
tail position, such a subroutine is said to be tail-recursive,
which is a special case of recursion. Tail calls are significant
because they can be implemented without adding a new stack frame
to the call stack. Most of the frame of the current procedure is
not needed any more, and it can be replaced by the frame of the
tail call. The program can then jump to the called
subroutine. Producing such code instead of a standard call
sequence is called tail call elimination, or tail call
optimization. Tail call elimination allows procedure calls in tail
position to be implemented as efficiently as goto statements, thus
allowing efficient structured programming.</p>
<p class="attribution">&mdash;Wikipedia (<a class="reference external" href="http://en.wikipedia.org/wiki/Tail_call">http://en.wikipedia.org/wiki/Tail_call</a>)</p>
</div></blockquote>
<div class="section" id="macros">
<h2>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loop">
<span id="id1"></span><h3>loop<a class="headerlink" href="#loop" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">loop</span></tt> establishes a recursion point. With <tt class="docutils literal"><span class="pre">loop</span></tt>, <tt class="docutils literal"><span class="pre">recur</span></tt>
rebinds the variables set in the recursion point and sends code
execution back to that recursion point. If <tt class="docutils literal"><span class="pre">recur</span></tt> is used in a
non-tail position, an exception is thrown.</p>
<p>Usage: <cite>(loop bindings &amp;rest body)</cite></p>
<p>Example:</p>
<div class="highlight-hy"><div class="highlight"><pre><span class="o">(</span><span class="n">require</span> <span class="n">hy</span><span class="o">.</span><span class="na">contrib</span><span class="o">.</span><span class="na">loop</span><span class="o">)</span>

<span class="o">(</span><span class="n">defn</span> <span class="n">factorial</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span>
  <span class="o">(</span><span class="n">loop</span> <span class="o">[[</span><span class="n">i</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">acc</span> <span class="mi">1</span><span class="o">]]</span>
    <span class="o">(</span><span class="k">if</span> <span class="o">(</span><span class="n">zero</span><span class="o">?</span> <span class="n">i</span><span class="o">)</span>
      <span class="n">acc</span>
      <span class="o">(</span><span class="n">recur</span> <span class="o">(</span><span class="n">dec</span> <span class="n">i</span><span class="o">)</span> <span class="o">(*</span> <span class="n">acc</span> <span class="n">i</span><span class="o">)))))</span>

<span class="o">(</span><span class="n">factorial</span> <span class="mi">1000</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">loop/recur</a><ul>
<li><a class="reference internal" href="#macros">Macros</a><ul>
<li><a class="reference internal" href="#loop">loop</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="anaphoric.html"
                        title="previous chapter">Anaphoric Macros</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="multi.html"
                        title="next chapter">defmulti</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../sources/contrib/loop.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="multi.html" title="defmulti"
             >next</a> |</li>
        <li class="right" >
          <a href="anaphoric.html" title="Anaphoric Macros"
             >previous</a> |</li>
        <li><a href="../index.html">hy 0.10.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Contrib Modules Index</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2014, Paul Tagliamonte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>